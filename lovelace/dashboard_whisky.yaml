# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘ DASHBOARD WHISKY - ULTRA COMPLET                                          â•‘
# â•‘ Design moderne + Monitoring + Configuration                               â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

title: Whisky
icon: mdi:glass-cocktail

views:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VUE 1 : DASHBOARD PREMIUM AVEC ANIMATIONS
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Dashboard
    path: dashboard
    icon: mdi:view-dashboard
    theme: Mushroom Shadow
    cards:
      # Hero Card Glassmorphism
      - type: custom:button-card
        entity: sensor.cumulus_temperature_estimee
        name: |
          [[[
            return '<span class="hero-title">ğŸ’§ Cumulus Intelligent</span>';
          ]]]
        label: |
          [[[
            const temp = Math.round(entity.state);
            const litres = states['sensor.cumulus_litres_disponibles']?.state || 0;
            const is_heating = states['switch.shellypro1_ece334ee1b64'].state === 'on';
    
            if (is_heating) {
              const time = states['sensor.cumulus_temps_restant_chauffe']?.state || 0;
              return `<span class="hero-heating">ğŸ”¥ Chauffe en cours - ${time} minutes restantes</span>`;
            } else {
              const douches = Math.floor(litres / 80);
              if (douches >= 3) {
                return `<span class="hero-ready">âœ¨ Parfait - ${douches} douches disponibles</span>`;
              } else if (douches >= 1) {
                return `<span class="hero-warning">âš¡ ${douches} douche${douches > 1 ? 's' : ''} disponible${douches > 1 ? 's' : ''}</span>`;
              } else {
                return `<span class="hero-alert">â„ï¸ Eau froide - Chauffe nÃ©cessaire</span>`;
              }
            }
          ]]]
        show_label: true
        show_state: false
        show_icon: false
        styles:
          card:
            - height: 200px
            - background: |
                [[[
                  const temp = parseFloat(entity.state);
                  const is_heating = states['switch.shellypro1_ece334ee1b64'].state === 'on';
    
                  if (is_heating) {
                    return `linear-gradient(135deg, rgba(255, 107, 107, 0.9) 0%, rgba(255, 154, 0, 0.9) 100%), url('/local/images/water-bubble.jpg')`;
                  } else if (temp >= 55) {
                    return `linear-gradient(135deg, rgba(81, 207, 102, 0.9) 0%, rgba(105, 219, 124, 0.9) 100%), url('/local/images/water-bubble.jpg')`;
                  } else if (temp >= 45) {
                    return `linear-gradient(135deg, rgba(255, 212, 59, 0.9) 0%, rgba(250, 176, 5, 0.9) 100%), url('/local/images/water-bubble.jpg')`;
                  } else {
                    return `linear-gradient(135deg, rgba(134, 142, 150, 0.9) 0%, rgba(173, 181, 189, 0.9) 100%), url('/local/images/water-bubble.jpg')`;
                  }
                ]]]
            - background-size: cover
            - background-position: center
            - border-radius: 30px
            - box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.3)
            - backdrop-filter: blur(10px)
            - border: 1px solid rgba(255, 255, 255, 0.2)
        custom_fields:
          temperature_display:
            card:
              type: custom:button-card
              entity: sensor.cumulus_temperature_estimee
              show_state: true
              state_display: |
                [[[
                  return `${Math.round(entity.state)}Â°C`;
                ]]]
              styles:
                card:
                  - background: transparent
                  - position: absolute
                  - top: 20px
                  - right: 30px
                state:
                  - font-size: 3.5em
                  - font-weight: 700
                  - color: rgba(255, 255, 255, 0.95)
                  - text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3)

      # Graphique ApexCharts
      - type: custom:apexcharts-card
        header:
          show: true
          title: Performance Temps RÃ©el
          show_states: true
        graph_span: 6h
        update_interval: 30s
        apex_config:
          chart:
            height: 280
            animations:
              enabled: true
          grid:
            borderColor: 'rgba(102, 126, 234, 0.1)'
          stroke:
            curve: smooth
            width: 3
        yaxis:
          - id: temp
            apex_config:
              title:
                text: TempÃ©rature (Â°C)
          - id: power
            opposite: true
            apex_config:
              title:
                text: Puissance (W)
        series:
          - entity: sensor.cumulus_temperature_estimee
            name: TempÃ©rature
            color: '#ff6b6b'
            type: area
            yaxis_id: temp
          - entity: sensor.cumulus_pv_power_w
            name: Production PV
            color: '#ffd43b'
            yaxis_id: power

      # Actions
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            name: Forcer Chauffe
            icon: mdi:fire
            tap_action:
              action: call-service
              service: switch.toggle
              service_data:
                entity_id: switch.shellypro1_ece334ee1b64
              confirmation:
                text: "DÃ©marrer une chauffe ?"
            styles:
              card:
                - height: 100px
                - background: linear-gradient(145deg, #ff7b7b, #ff5e5e)
                - border-radius: 20px

          - type: custom:button-card
            name: Mode Ã‰conomie
            icon: mdi:leaf
            entity: input_select.cumulus_strategie_optimisation
            tap_action:
              action: call-service
              service: input_select.select_next
              service_data:
                entity_id: input_select.cumulus_strategie_optimisation
            show_state: true
            styles:
              card:
                - height: 100px
                - background: linear-gradient(145deg, #e8f5e9, #c8e6c9)
                - border-radius: 20px

      # Statistiques
      - type: grid
        columns: 3
        cards:
          - type: custom:button-card
            name: Autonomie
            entity: sensor.cumulus_autonomie_solaire
            show_state: true
            styles:
              card:
                - background: rgba(81, 207, 102, 0.1)
                - border-radius: 15px

          - type: custom:button-card
            name: Ã‰conomies
            entity: sensor.cumulus_cout_mois
            show_state: true
            styles:
              card:
                - background: rgba(102, 126, 234, 0.1)
                - border-radius: 15px

          - type: custom:button-card
            name: EfficacitÃ©
            entity: sensor.cumulus_efficacite_systeme
            show_state: true
            styles:
              card:
                - background: rgba(255, 212, 59, 0.1)
                - border-radius: 15px

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VUE 2 : MONITORING DÃ‰TAILLÃ‰
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Monitoring
    path: monitoring
    icon: mdi:chart-line
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: Monitoring Temps RÃ©el
            subtitle: Informations dÃ©taillÃ©es

          - type: horizontal-stack
            cards:
              - type: custom:mushroom-entity-card
                entity: binary_sensor.cumulus_chauffe_reelle
                name: Chauffe rÃ©elle
              - type: custom:mushroom-entity-card
                entity: binary_sensor.cumulus_capacite_suffisante
                name: CapacitÃ© OK

          - type: horizontal-stack
            cards:
              - type: custom:mushroom-entity-card
                entity: binary_sensor.cumulus_meteo_favorable_aujourdhui
                name: MÃ©tÃ©o aujourd'hui
              - type: custom:mushroom-entity-card
                entity: binary_sensor.cumulus_meteo_favorable_demain
                name: MÃ©tÃ©o demain

          - type: custom:mushroom-title-card
            title: PrÃ©visions Solaires
            subtitle: Solcast PV Forecast

          - type: horizontal-stack
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.solcast_pv_forecast_previsions_pour_aujourd_hui
                name: PrÃ©vision aujourd'hui
                icon: mdi:solar-power
              - type: custom:mushroom-entity-card
                entity: sensor.solcast_pv_forecast_previsions_pour_demain
                name: PrÃ©vision demain
                icon: mdi:solar-power-variant

          - type: custom:mushroom-title-card
            title: Mesures
            subtitle: Consommation et puissance

          - type: horizontal-stack
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.cumulus_consommation_reelle_w
                name: Consommation
              - type: custom:mushroom-entity-card
                entity: sensor.cumulus_pv_effectif_w
                name: PV effectif

          - type: horizontal-stack
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.cumulus_temperature_estimee
                name: Temp estimÃ©e
              - type: custom:mushroom-entity-card
                entity: sensor.cumulus_litres_disponibles_estimes
                name: Litres dispos

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VUE 3 : CONFIGURATION
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Configuration
    path: configuration
    icon: mdi:cog
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: RÃ©glages de Base

          - type: entities
            entities:
              - input_number.cumulus_capacite_litres
              - input_number.cumulus_nb_personnes
              - input_number.cumulus_puissance_w
              - input_number.cumulus_temperature_cible_c
              - input_number.cumulus_talon_maison_w

          - type: custom:mushroom-title-card
            title: Config PV & Solarbank

          - type: entities
            entities:
              - input_number.cumulus_seuil_pv_on_w
              - input_number.cumulus_soc_start_pct
              - input_number.cumulus_soc_stop_pct
              - input_number.cumulus_solarbank_max_w
