title: Design Glassmorphique
icon: mdi:palette

views:
  # ========================================
  # VUE 0 : CUMULUS PRINCIPAL (Style Glassmorphique)
  # ========================================
  - title: Cumulus
    path: cumulus-design
    icon: mdi:water-boiler
    cards:
      # === En-t√™te avec navigation style glassmorphique ===
      - type: custom:mod-card
        style: |
          ha-card {
            background: transparent !important;
            box-shadow: none !important;
            border: none !important;
            position: fixed;
            left: 50%;
            top: 12px;
            transform: translateX(-50%);
            width: calc(100% - 32px);
            max-width: 1200px;
            z-index: 999;
          }
        card:
          type: horizontal-stack
          cards:
            # Bouton Info
            - type: custom:button-card
              icon: mdi:information-slab-circle
              show_name: false
              tap_action:
                action: navigate
                navigation_path: /lovelace-design/config-design
              styles:
                card:
                  - background: rgba(60, 60, 60, 0.4)
                  - border-radius: 30px
                  - padding: 10px
                  - backdrop-filter: blur(12px)
                  - -webkit-backdrop-filter: blur(12px)
                  - box-shadow: 2px 3px 7px rgba(0, 0, 0, 0.6)
                  - border: none
                icon:
                  - color: rgb(0, 200, 255)
                  - width: 22px
              card_mod:
                style: |
                  ha-card::before {
                    content: "";
                    position: absolute;
                    inset: 0;
                    border-radius: 30px;
                    padding: 1px;
                    background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                    -webkit-mask-composite: xor;
                    mask-composite: exclude;
                    pointer-events: none;
                    z-index: 2;
                  }

            # Spacer
            - type: custom:button-card
              color_type: blank-card
              styles:
                card:
                  - background: none
                  - box-shadow: none
                  - border: none

            # Horloge centrale
            - type: clock
              show_seconds: false
              card_mod:
                style: |
                  ha-card {
                    background: transparent !important;
                    box-shadow: none !important;
                    border: none !important;
                    color: rgb(255, 255, 255);
                    font-size: 1.2em;
                    font-weight: 600;
                    text-align: center;
                  }

      # === Spacer pour √©viter chevauchement header ===
      - type: custom:mod-card
        style: |
          ha-card {
            height: 60px;
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
        card:
          type: markdown
          content: " "

      # === Carte principale Cumulus ===
      - type: custom:mod-card
        style: |
          ha-card {
            background: transparent !important;
            border-radius: 30px !important;
            padding: 0px !important;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            box-shadow: 2px 2px 9px rgba(0, 0, 0, 0.8);
            border: none !important;
          }
          :host::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 30px !important;
            padding: 1px;
            background: linear-gradient(140deg, rgba(170, 170, 170, 0.5) 10%, rgba(0, 0, 0, 0) 70%, rgba(180, 180, 180, 0) 90%);
            -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
            z-index: 2;
          }
        card:
          type: vertical-stack
          cards:
            # Titre principal avec ic√¥ne
            - type: custom:bubble-card
              card_type: button
              button_type: name
              icon: mdi:water-boiler
              name: "üíß C U M U L U S   I N T E L L I G E N T"
              show_state: false
              sub_button: []
              styles: |-
                :host {
                  --bubble-main-background-color: transparent !important;
                  --bubble-icon-background-color: rgba(6, 182, 212, 0.3) !important;
                  --bubble-box-shadow: none !important;
                }
                .bubble-name {
                  color: rgb(200, 200, 220) !important;
                  font-weight: 600 !important;
                  font-size: 1.1rem !important;
                  letter-spacing: 2px !important;
                }
                .bubble-icon-container {
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                }
                .bubble-icon {
                  color: rgb(6, 182, 212) !important;
                }
                .bubble-icon-container::before {
                  content: "";
                  position: absolute;
                  inset: 0px;
                  border-radius: 30px !important;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              button_action:
                tap_action:
                  action: none
                hold_action:
                  action: none

            # Statut et contr√¥les
            - type: horizontal-stack
              cards:
                # √âtat de chauffe avec animation
                - type: custom:button-card
                  entity: switch.shellypro1_ece334ee1b64
                  name: STATUT
                  show_state: false
                  show_icon: true
                  icon: |
                    [[[
                      if (entity.state === 'on') {
                        const switch_last_changed = new Date(entity.last_changed).getTime();
                        const now = Date.now();
                        const seconds_since_on = (now - switch_last_changed) / 1000;
                        if (seconds_since_on < 10) return 'mdi:fire';

                        const import_w = parseFloat(states['sensor.smart_meter_grid_import'].state) || 0;
                        const pv_w = parseFloat(states['sensor.cumulus_pv_power_w'].state) || 0;
                        const talon = parseFloat(states['input_number.cumulus_talon_maison_w'].state) || 300;
                        const conso = (import_w + pv_w) - talon;

                        if (conso >= 2000) return 'mdi:fire';
                        return 'mdi:power-standby';
                      }
                      return 'mdi:power-off';
                    ]]]
                  custom_fields:
                    info: |
                      [[[
                        if (entity.state === 'on') {
                          const switch_last_changed = new Date(entity.last_changed).getTime();
                          const now = Date.now();
                          const seconds_since_on = (now - switch_last_changed) / 1000;
                          if (seconds_since_on < 10) return '<span>üî• EN CHAUFFE</span>';

                          const import_w = parseFloat(states['sensor.smart_meter_grid_import'].state) || 0;
                          const pv_w = parseFloat(states['sensor.cumulus_pv_power_w'].state) || 0;
                          const talon = parseFloat(states['input_number.cumulus_talon_maison_w'].state) || 300;
                          const conso = (import_w + pv_w) - talon;

                          if (conso >= 2000) return '<span>üî• CHAUFFE</span>';
                          return '<span>üü¢ STANDBY</span>';
                        }
                        return '<span>üí§ OFF</span>';
                      ]]]
                  styles:
                    card:
                      - min-height: 100px
                      - border-radius: 20px
                      - padding: 12px
                      - background: |
                          [[[
                            if (entity.state === 'on') {
                              const switch_last_changed = new Date(entity.last_changed).getTime();
                              const now = Date.now();
                              const seconds_since_on = (now - switch_last_changed) / 1000;
                              if (seconds_since_on < 10) return 'linear-gradient(135deg, rgba(255, 70, 0, 0.3), rgba(255, 140, 0, 0.2))';

                              const import_w = parseFloat(states['sensor.smart_meter_grid_import'].state) || 0;
                              const pv_w = parseFloat(states['sensor.cumulus_pv_power_w'].state) || 0;
                              const talon = parseFloat(states['input_number.cumulus_talon_maison_w'].state) || 300;
                              const conso = (import_w + pv_w) - talon;

                              if (conso >= 2000) return 'linear-gradient(135deg, rgba(255, 70, 0, 0.3), rgba(255, 140, 0, 0.2))';
                              return 'linear-gradient(135deg, rgba(0, 180, 200, 0.3), rgba(0, 100, 150, 0.2))';
                            }
                            return 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.9rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 32px
                      - color: |
                          [[[
                            if (entity.state === 'on') {
                              const switch_last_changed = new Date(entity.last_changed).getTime();
                              const now = Date.now();
                              const seconds_since_on = (now - switch_last_changed) / 1000;
                              if (seconds_since_on < 10) return '#ff4500';

                              const import_w = parseFloat(states['sensor.smart_meter_grid_import'].state) || 0;
                              const pv_w = parseFloat(states['sensor.cumulus_pv_power_w'].state) || 0;
                              const talon = parseFloat(states['input_number.cumulus_talon_maison_w'].state) || 300;
                              const conso = (import_w + pv_w) - talon;

                              if (conso >= 2000) return '#ff4500';
                              return '#00b4c8';
                            }
                            return '#94a3b8';
                          ]]]
                    custom_fields:
                      info:
                        - font-size: 0.85rem
                        - color: rgb(200, 200, 200)
                  tap_action:
                    action: toggle
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Besoin urgent
                - type: custom:button-card
                  entity: binary_sensor.cumulus_besoin_chauffe_urgente
                  name: BESOIN
                  show_state: false
                  show_icon: true
                  icon: |
                    [[[
                      return entity.state === 'on' ? 'mdi:alert-circle' : 'mdi:check-circle';
                    ]]]
                  custom_fields:
                    info: |
                      [[[
                        return entity.state === 'on' ? '<span>‚ö†Ô∏è URGENT</span>' : '<span>‚úÖ NORMAL</span>';
                      ]]]
                  styles:
                    card:
                      - min-height: 100px
                      - border-radius: 20px
                      - padding: 12px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(255, 140, 0, 0.2))'
                              : 'linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(0, 180, 100, 0.2))';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.9rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 32px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#ef4444' : '#22c55e';
                          ]]]
                    custom_fields:
                      info:
                        - font-size: 0.85rem
                        - color: rgb(200, 200, 200)
                  tap_action:
                    action: more-info
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

            # Production PV et Temps restant
            - type: horizontal-stack
              cards:
                # Production PV
                - type: custom:button-card
                  entity: sensor.cumulus_pv_power_w
                  name: PRODUCTION PV
                  show_state: false
                  show_icon: true
                  icon: mdi:solar-power-variant
                  custom_fields:
                    info: |
                      [[[
                        const pv = parseFloat(entity.state) || 0;
                        return `<span>${Math.round(pv)} W</span>`;
                      ]]]
                  styles:
                    card:
                      - min-height: 85px
                      - border-radius: 20px
                      - padding: 10px
                      - background: linear-gradient(135deg, rgba(251, 191, 36, 0.3), rgba(255, 200, 0, 0.2))
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 4px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 28px
                      - color: '#fbbf24'
                    custom_fields:
                      info:
                        - font-size: 1.1rem
                        - font-weight: 700
                        - color: rgb(251, 191, 36)
                  tap_action:
                    action: more-info
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Temps restant fen√™tre PV
                - type: custom:button-card
                  entity: sensor.cumulus_temps_restant_fenetre_pv_h
                  name: TEMPS RESTANT PV
                  show_state: false
                  show_icon: true
                  icon: mdi:timer-sand
                  custom_fields:
                    info: |
                      [[[
                        const temps = parseFloat(entity.state) || 0;
                        return `<span>${temps.toFixed(1)} h</span>`;
                      ]]]
                  styles:
                    card:
                      - min-height: 85px
                      - border-radius: 20px
                      - padding: 10px
                      - background: |
                          [[[
                            const temps = parseFloat(entity.state) || 0;
                            if (temps > 3) return 'linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(0, 180, 100, 0.2))';
                            if (temps > 1) return 'linear-gradient(135deg, rgba(251, 191, 36, 0.3), rgba(255, 200, 0, 0.2))';
                            if (temps > 0) return 'linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(255, 70, 0, 0.2))';
                            return 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 4px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 28px
                      - color: |
                          [[[
                            const temps = parseFloat(entity.state) || 0;
                            if (temps > 3) return '#22c55e';
                            if (temps > 1) return '#fbbf24';
                            if (temps > 0) return '#ef4444';
                            return '#94a3b8';
                          ]]]
                    custom_fields:
                      info:
                        - font-size: 1.1rem
                        - font-weight: 700
                        - color: |
                            [[[
                              const temps = parseFloat(entity.state) || 0;
                              if (temps > 3) return 'rgb(34, 197, 94)';
                              if (temps > 1) return 'rgb(251, 191, 36)';
                              if (temps > 0) return 'rgb(239, 68, 68)';
                              return 'rgb(148, 163, 184)';
                            ]]]
                  tap_action:
                    action: more-info
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

            # S√©parateur titre "CONTR√îLES"
            - type: custom:bubble-card
              card_type: button
              button_type: name
              icon: mdi:tune-variant
              name: "üéõÔ∏è  C O N T R √î L E S"
              show_state: false
              sub_button: []
              styles: |-
                :host {
                  --bubble-main-background-color: transparent !important;
                  --bubble-icon-background-color: rgba(59, 130, 246, 0.3) !important;
                  --bubble-box-shadow: none !important;
                }
                .bubble-name {
                  color: rgb(200, 200, 220) !important;
                  font-weight: 600 !important;
                  font-size: 1rem !important;
                  letter-spacing: 2px !important;
                }
                .bubble-icon-container {
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                }
                .bubble-icon {
                  color: rgb(59, 130, 246) !important;
                }
                .bubble-icon-container::before {
                  content: "";
                  position: absolute;
                  inset: 0px;
                  border-radius: 30px !important;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              button_action:
                tap_action:
                  action: none

            # Grille de contr√¥les (3 colonnes)
            - type: custom:layout-card
              layout_type: grid
              layout:
                grid-template-columns: 1fr 1fr 1fr
                column-gap: 8px
                row-gap: 8px
              cards:
                # Forcer
                - type: custom:button-card
                  entity: input_boolean.cumulus_override
                  name: FORCER
                  show_state: false
                  show_icon: true
                  icon: mdi:hand-pointing-up
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(239, 68, 68, 0.35), rgba(255, 70, 0, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#ef4444' : '#94a3b8';
                          ]]]
                      - animation: |
                          [[[
                            return entity.state === 'on' ? 'blink 1.5s linear infinite' : 'none';
                          ]]]
                  tap_action:
                    action: toggle
                    confirmation:
                      text: Forcer la chauffe imm√©diate ?
                  card_mod:
                    style: |
                      @keyframes blink {
                        0%   { opacity: 1; }
                        50%  { opacity: 0.3; }
                        100% { opacity: 1; }
                      }
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Interdit
                - type: custom:button-card
                  entity: input_boolean.cumulus_interdit
                  name: INTERDIT
                  show_state: false
                  show_icon: true
                  icon: mdi:cancel
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(239, 68, 68, 0.35), rgba(255, 70, 0, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#ef4444' : '#94a3b8';
                          ]]]
                  tap_action:
                    action: toggle
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Vacances
                - type: custom:button-card
                  entity: input_boolean.cumulus_vacances
                  name: VACANCES
                  show_state: false
                  show_icon: true
                  icon: mdi:beach
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(251, 191, 36, 0.35), rgba(255, 200, 0, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#fbbf24' : '#94a3b8';
                          ]]]
                  tap_action:
                    action: toggle
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # HC autoris√©es
                - type: custom:button-card
                  entity: input_boolean.cumulus_autoriser_hc
                  name: HC AUTORIS√âES
                  show_state: false
                  show_icon: true
                  icon: mdi:clock-time-eight
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(59, 130, 246, 0.35), rgba(0, 150, 255, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#3b82f6' : '#94a3b8';
                          ]]]
                  tap_action:
                    action: toggle
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Verrou jour (lecture seule)
                - type: custom:button-card
                  entity: input_boolean.cumulus_verrou_jour
                  name: VERROU JOUR
                  show_state: false
                  show_icon: true
                  icon: mdi:lock-check
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(251, 191, 36, 0.3), rgba(255, 200, 0, 0.2))'
                              : 'linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(0, 180, 100, 0.2))';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#fbbf24' : '#22c55e';
                          ]]]
                  tap_action:
                    action: none
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Temp√©rature OK (lecture seule)
                - type: custom:button-card
                  entity: input_boolean.temp_atteinte_aujourdhui
                  name: TEMP. OK
                  show_state: false
                  show_icon: true
                  icon: mdi:thermometer-check
                  styles:
                    card:
                      - min-height: 75px
                      - border-radius: 20px
                      - padding: 8px
                      - background: |
                          [[[
                            return entity.state === 'on'
                              ? 'linear-gradient(135deg, rgba(34, 197, 94, 0.35), rgba(0, 180, 100, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n"'
                      - grid-template-rows: auto auto
                      - row-gap: 6px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 26px
                      - color: |
                          [[[
                            return entity.state === 'on' ? '#22c55e' : '#94a3b8';
                          ]]]
                  tap_action:
                    action: none
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

            # S√©parateur titre "PR√âVISIONS SOLAIRES"
            - type: custom:bubble-card
              card_type: button
              button_type: name
              icon: mdi:weather-sunny
              name: "‚òÄÔ∏è  P R √â V I S I O N S   S O L A I R E S"
              show_state: false
              sub_button: []
              styles: |-
                :host {
                  --bubble-main-background-color: transparent !important;
                  --bubble-icon-background-color: rgba(251, 191, 36, 0.3) !important;
                  --bubble-box-shadow: none !important;
                }
                .bubble-name {
                  color: rgb(200, 200, 220) !important;
                  font-weight: 600 !important;
                  font-size: 1rem !important;
                  letter-spacing: 2px !important;
                }
                .bubble-icon-container {
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                }
                .bubble-icon {
                  color: rgb(251, 191, 36) !important;
                }
                .bubble-icon-container::before {
                  content: "";
                  position: absolute;
                  inset: 0px;
                  border-radius: 30px !important;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              button_action:
                tap_action:
                  action: none

            # Pr√©visions Solcast
            - type: horizontal-stack
              cards:
                # Aujourd'hui
                - type: custom:button-card
                  entity: sensor.cumulus_solcast_forecast_today
                  name: AUJOURD'HUI
                  show_state: false
                  show_icon: true
                  icon: mdi:weather-sunny
                  custom_fields:
                    info: |
                      [[[
                        return `<span>${entity.state} kWh</span>`;
                      ]]]
                  styles:
                    card:
                      - min-height: 85px
                      - border-radius: 20px
                      - padding: 10px
                      - background: |
                          [[[
                            return states['binary_sensor.cumulus_meteo_favorable_aujourdhui'].state === 'on'
                              ? 'linear-gradient(135deg, rgba(251, 191, 36, 0.35), rgba(255, 200, 0, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 4px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 28px
                      - color: |
                          [[[
                            return states['binary_sensor.cumulus_meteo_favorable_aujourdhui'].state === 'on'
                              ? '#fbbf24' : '#94a3b8';
                          ]]]
                    custom_fields:
                      info:
                        - font-size: 1.1rem
                        - font-weight: 700
                        - color: |
                            [[[
                              return states['binary_sensor.cumulus_meteo_favorable_aujourdhui'].state === 'on'
                                ? 'rgb(251, 191, 36)' : 'rgb(148, 163, 184)';
                            ]]]
                  tap_action:
                    action: more-info
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

                # Demain
                - type: custom:button-card
                  entity: sensor.cumulus_solcast_forecast_tomorrow
                  name: DEMAIN
                  show_state: false
                  show_icon: true
                  icon: mdi:weather-sunny-alert
                  custom_fields:
                    info: |
                      [[[
                        return `<span>${entity.state} kWh</span>`;
                      ]]]
                  styles:
                    card:
                      - min-height: 85px
                      - border-radius: 20px
                      - padding: 10px
                      - background: |
                          [[[
                            return states['binary_sensor.cumulus_meteo_favorable_demain'].state === 'on'
                              ? 'linear-gradient(135deg, rgba(251, 191, 36, 0.35), rgba(255, 200, 0, 0.25))'
                              : 'rgba(60, 60, 60, 0.4)';
                          ]]]
                      - backdrop-filter: blur(6px)
                      - -webkit-backdrop-filter: blur(12px)
                      - box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6)
                    grid:
                      - grid-template-areas: '"i" "n" "info"'
                      - grid-template-rows: auto auto auto
                      - row-gap: 4px
                    name:
                      - font-weight: 600
                      - font-size: 0.85rem
                      - color: rgb(200, 200, 200)
                    icon:
                      - width: 28px
                      - color: |
                          [[[
                            return states['binary_sensor.cumulus_meteo_favorable_demain'].state === 'on'
                              ? '#fbbf24' : '#94a3b8';
                          ]]]
                    custom_fields:
                      info:
                        - font-size: 1.1rem
                        - font-weight: 700
                        - color: |
                            [[[
                              return states['binary_sensor.cumulus_meteo_favorable_demain'].state === 'on'
                                ? 'rgb(251, 191, 36)' : 'rgb(148, 163, 184)';
                            ]]]
                  tap_action:
                    action: more-info
                  card_mod:
                    style: |
                      ha-card::before {
                        content: "";
                        position: absolute;
                        inset: 0;
                        border-radius: 20px;
                        padding: 1px;
                        background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                        -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                        -webkit-mask-composite: xor;
                        mask-composite: exclude;
                        pointer-events: none;
                        z-index: 2;
                      }

  # ========================================
  # VUE 1 : CONFIGURATION (Style Glassmorphique)
  # ========================================
  - title: Configuration
    path: config-design
    icon: mdi:cog
    cards:
      # Spacer pour header
      - type: custom:mod-card
        style: |
          ha-card {
            height: 20px;
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
        card:
          type: markdown
          content: " "

      # Carte principale configuration
      - type: custom:mod-card
        style: |
          ha-card {
            background: transparent !important;
            border-radius: 30px !important;
            padding: 0px !important;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            box-shadow: 2px 2px 9px rgba(0, 0, 0, 0.8);
            border: none !important;
          }
          :host::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 30px !important;
            padding: 1px;
            background: linear-gradient(140deg, rgba(170, 170, 170, 0.5) 10%, rgba(0, 0, 0, 0) 70%, rgba(180, 180, 180, 0) 90%);
            -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
            z-index: 2;
          }
        card:
          type: vertical-stack
          cards:
            # Titre
            - type: custom:bubble-card
              card_type: button
              button_type: name
              icon: mdi:cog
              name: "‚öôÔ∏è  C O N F I G U R A T I O N"
              show_state: false
              sub_button: []
              styles: |-
                :host {
                  --bubble-main-background-color: transparent !important;
                  --bubble-icon-background-color: rgba(148, 163, 184, 0.3) !important;
                  --bubble-box-shadow: none !important;
                }
                .bubble-name {
                  color: rgb(200, 200, 220) !important;
                  font-weight: 600 !important;
                  font-size: 1.1rem !important;
                  letter-spacing: 2px !important;
                }
                .bubble-icon-container {
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                }
                .bubble-icon {
                  color: rgb(148, 163, 184) !important;
                }
              button_action:
                tap_action:
                  action: none

            # R√©glages de base
            - type: custom:mod-card
              style: |
                ha-card {
                  background: rgba(60, 60, 60, 0.3) !important;
                  border-radius: 20px !important;
                  padding: 8px !important;
                  backdrop-filter: blur(6px);
                  -webkit-backdrop-filter: blur(12px);
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                  border: none !important;
                }
                ha-card::before {
                  content: "";
                  position: absolute;
                  inset: 0;
                  border-radius: 20px;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              card:
                type: entities
                title: "üîß R√©glages de base"
                show_header_toggle: false
                entities:
                  - entity: input_number.cumulus_capacite_litres
                    name: Capacit√© (L)
                  - entity: input_number.cumulus_nb_personnes
                    name: Nombre de personnes
                  - entity: input_number.cumulus_puissance_w
                    name: Puissance (W)
                  - entity: input_number.cumulus_temperature_cible_c
                    name: Temp√©rature cible (¬∞C)
                  - entity: input_number.cumulus_talon_maison_w
                    name: Talon maison (W)

            # Config PV
            - type: custom:mod-card
              style: |
                ha-card {
                  background: rgba(60, 60, 60, 0.3) !important;
                  border-radius: 20px !important;
                  padding: 8px !important;
                  backdrop-filter: blur(6px);
                  -webkit-backdrop-filter: blur(12px);
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                  border: none !important;
                  margin-top: 8px !important;
                }
                ha-card::before {
                  content: "";
                  position: absolute;
                  inset: 0;
                  border-radius: 20px;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              card:
                type: entities
                title: "‚òÄÔ∏è Configuration PV & Solarbank"
                show_header_toggle: false
                entities:
                  - entity: input_number.cumulus_seuil_pv_on_w
                    name: Seuil PV ON (W)
                  - entity: input_number.cumulus_soc_start_pct
                    name: SOC d√©marrage (%)
                  - entity: input_number.cumulus_soc_stop_pct
                    name: SOC arr√™t (%)
                  - entity: input_number.cumulus_solarbank_max_w
                    name: Solarbank Max (W)

            # Horaires
            - type: custom:mod-card
              style: |
                ha-card {
                  background: rgba(60, 60, 60, 0.3) !important;
                  border-radius: 20px !important;
                  padding: 8px !important;
                  backdrop-filter: blur(6px);
                  -webkit-backdrop-filter: blur(12px);
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                  border: none !important;
                  margin-top: 8px !important;
                }
                ha-card::before {
                  content: "";
                  position: absolute;
                  inset: 0;
                  border-radius: 20px;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              card:
                type: entities
                title: "üïê Fen√™tres horaires"
                show_header_toggle: false
                entities:
                  - entity: input_datetime.cumulus_plage_pv_debut
                    name: Fen√™tre PV - D√©but
                  - entity: input_datetime.cumulus_plage_pv_fin
                    name: Fen√™tre PV - Fin
                  - entity: binary_sensor.cumulus_fenetre_pv
                    name: Dans fen√™tre PV
                  - type: divider
                  - entity: input_datetime.cumulus_heures_creuses_debut
                    name: HC - D√©but
                  - entity: input_datetime.cumulus_heures_creuses_fin
                    name: HC - Fin
                  - entity: binary_sensor.cumulus_en_hc
                    name: En heures creuses

            # Donn√©es techniques
            - type: custom:mod-card
              style: |
                ha-card {
                  background: rgba(60, 60, 60, 0.3) !important;
                  border-radius: 20px !important;
                  padding: 8px !important;
                  backdrop-filter: blur(6px);
                  -webkit-backdrop-filter: blur(12px);
                  box-shadow: 2px 1px 6px rgba(0, 0, 0, 0.6);
                  border: none !important;
                  margin-top: 8px !important;
                }
                ha-card::before {
                  content: "";
                  position: absolute;
                  inset: 0;
                  border-radius: 20px;
                  padding: 1px;
                  background: linear-gradient(140deg, rgba(170, 170, 170, 0.7) 10%, rgba(0, 0, 0, 0) 70%);
                  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
                  -webkit-mask-composite: xor;
                  mask-composite: exclude;
                  pointer-events: none;
                  z-index: 2;
                }
              card:
                type: entities
                title: "üìä Donn√©es techniques"
                show_header_toggle: false
                state_color: true
                entities:
                  - entity: sensor.cumulus_temperature_physique_c
                    name: Temp√©rature estim√©e
                  - entity: sensor.cumulus_eau_chaude_disponible_40c_litres
                    name: Litres disponibles (40¬∞C)
                  - entity: sensor.cumulus_besoin_journalier_litres
                    name: Besoin journalier
                  - type: divider
                  - entity: sensor.cumulus_heures_depuis_derniere_chauffe
                    name: Heures depuis derni√®re chauffe
                  - entity: input_datetime.cumulus_derniere_chauffe_complete
                    name: Derni√®re chauffe compl√®te

            # Footer
            - type: markdown
              content: |
                <div style="text-align: center; color: rgba(200, 200, 200, 0.6); font-size: 10px; padding: 8px;">
                  üíß Dashboard Design Glassmorphique ‚Ä¢ Inspir√© de style-home-assistant
                </div>
              card_mod:
                style: |
                  ha-card {
                    background: transparent !important;
                    box-shadow: none !important;
                    border: none !important;
                  }
