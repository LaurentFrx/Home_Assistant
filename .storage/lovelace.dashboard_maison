{
  "version": 1,
  "minor_version": 1,
  "key": "lovelace.dashboard_maison",
  "data": {
    "config": {
      "views": [
        {
          "icon": "mdi:home-thermometer",
          "theme": "ios-light-mode-dark-green-alternative",
          "badges": [],
          "cards": [
            {
              "type": "custom:clock-weather-card",
              "entity": "weather.sanguinet",
              "time_format": 24,
              "hide_clock": true,
              "date_pattern": "ccc d LLL",
              "show_humidity": true,
              "humidity_sensor": "sensor.thermo_ext_humidity"
            },
            {
              "type": "custom:versatile-thermostat-ui-card",
              "entity": "climate.thermostat_sdb",
              "name": "SDB",
              "disable_off": false,
              "disable_menu": true,
              "disable_security_warning": false,
              "disable_buttons": false,
              "disable_power_infos": true,
              "disable_auto_fan_infos": true,
              "disable_auto": false,
              "disable_cool": true,
              "disable_heat_cool": true,
              "disable_heat": false,
              "disable_window": true,
              "disable_overpowering": false,
              "disable_fan_only": false
            },
            {
              "type": "custom:simple-thermostat",
              "card_mod": {
                "style": "ha-card {\n  --st-font-size-xl: 24px;\n  --st-font-size-m: 18px;\n  --st-font-size-title: 20px;\n  --st-font-size-sensors: 18px;\n  --st-spacing: 2px;\n}\n.mode-item {\n  --border-radius: 20px;\n}\n"
              },
              "header": {
                "name": "Séjour",
                "icon": "mdi:sofa"
              },
              "entity": "climate.daikin_split_salon_room_temperature",
              "hide": {
                "temperature": true,
                "state": true
              },
              "layout": {
                "mode": {
                  "headings": false
                }
              },
              "step_size": 0.5,
              "decimals": 1,
              "sensors": [
                {
                  "entity": "sensor.thermo_salon_temperature",
                  "icon": "mdi:home-thermometer-outline",
                  "name": "Température"
                },
                {
                  "entity": "sensor.thermo_salon_humidity",
                  "icon": "mdi:water",
                  "name": "Humidité"
                }
              ],
              "control": {
                "fan": {
                  "quiet": {
                    "name": "Silence"
                  }
                },
                "hvac": {
                  "off": {
                    "icon": "mdi:power"
                  },
                  "heat": {
                    "name": "Chauffage",
                    "icon": "mdi:fire"
                  },
                  "cool": {
                    "name": "Froid"
                  },
                  "heat_cool": false,
                  "dry": false,
                  "fan_only": false
                }
              }
            },
            {
              "type": "custom:vertical-stack-in-card",
              "cards": [
                {
                  "type": "custom:mushroom-climate-card",
                  "entity": "climate.bureau",
                  "tap_action": {
                    "action": "none"
                  },
                  "hold_action": {
                    "action": "more-info"
                  },
                  "double_tap_action": {
                    "action": "none"
                  },
                  "show_temperature_control": true,
                  "hvac_modes": [
                    "heat",
                    "off",
                    "cool"
                  ],
                  "layout": "horizontal",
                  "icon": "mdi:desktop-classic",
                  "secondary_info": "none"
                },
                {
                  "type": "grid",
                  "square": false,
                  "columns": 2,
                  "cards": [
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.bureau_temperature",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Temperature",
                      "icon_color": "green"
                    },
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.bureau_humidite",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Humidity",
                      "icon_color": "blue"
                    }
                  ]
                }
              ]
            },
            {
              "type": "custom:vertical-stack-in-card",
              "cards": [
                {
                  "type": "custom:mushroom-climate-card",
                  "entity": "climate.amis",
                  "tap_action": {
                    "action": "none"
                  },
                  "hold_action": {
                    "action": "more-info"
                  },
                  "double_tap_action": {
                    "action": "none"
                  },
                  "show_temperature_control": true,
                  "hvac_modes": [
                    "heat",
                    "off",
                    "cool"
                  ],
                  "layout": "horizontal",
                  "icon": "mdi:bed-king-outline",
                  "secondary_info": "none"
                },
                {
                  "type": "grid",
                  "square": false,
                  "columns": 2,
                  "cards": [
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.amis_temperature",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Temperature",
                      "icon_color": "green"
                    },
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.amis_humidite",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Humidity",
                      "icon_color": "blue"
                    }
                  ]
                }
              ]
            },
            {
              "type": "custom:vertical-stack-in-card",
              "cards": [
                {
                  "type": "custom:mushroom-climate-card",
                  "entity": "climate.parents",
                  "tap_action": {
                    "action": "none"
                  },
                  "hold_action": {
                    "action": "more-info"
                  },
                  "double_tap_action": {
                    "action": "none"
                  },
                  "show_temperature_control": true,
                  "hvac_modes": [
                    "heat",
                    "off",
                    "cool"
                  ],
                  "layout": "horizontal",
                  "icon": "mdi:bed-king",
                  "secondary_info": "none"
                },
                {
                  "type": "grid",
                  "square": false,
                  "columns": 2,
                  "cards": [
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.parents_temperature",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Temperature",
                      "icon_color": "green"
                    },
                    {
                      "type": "custom:mushroom-entity-card",
                      "entity": "sensor.amis_humidite",
                      "primary_info": "state",
                      "secondary_info": "name",
                      "name": "Humidity",
                      "icon_color": "blue"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "icon": "mdi:devices",
          "badges": [],
          "cards": [
            {
              "type": "custom:vertical-stack-in-card",
              "cards": [
                {
                  "type": "custom:layout-card",
                  "layout_type": "grid",
                  "layout": {
                    "grid-template-columns": "repeat(4, 1fr)",
                    "column-gap": "4px",
                    "row-gap": "4px"
                  },
                  "cards": [
                    {
                      "type": "custom:button-card",
                      "entity": "switch.chargeur_isa",
                      "name": "Chargeur",
                      "label": "Isa",
                      "icon": "mdi:battery-charging",
                      "show_state": false,
                      "show_label": true,
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "0px 0px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  return (entity?.state === 'on')\n    ? 'linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.06))'\n    : 'linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))';\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n\" \"i l\""
                          },
                          {
                            "grid-template-columns": "28px 1fr"
                          },
                          {
                            "row-gap": "2px"
                          }
                        ],
                        "icon": [
                          {
                            "width": "22px"
                          },
                          {
                            "color": "[[[\n  return (entity?.state === 'on') ? '#ef4444' : '#0ea5e9';\n]]]\n"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "end"
                          },
                          {
                            "font-weight": 700
                          },
                          {
                            "font-size": ".82rem"
                          }
                        ],
                        "label": [
                          {
                            "align-self": "start"
                          },
                          {
                            "font-size": "1rem"
                          },
                          {
                            "opacity": 0.9
                          }
                        ]
                      },
                      "tap_action": {
                        "action": "toggle"
                      }
                    },
                    {
                      "type": "custom:button-card",
                      "entity": "switch.chargeur_laurent",
                      "name": "Chargeur",
                      "label": "Lau",
                      "icon": "mdi:battery-charging",
                      "show_state": false,
                      "show_label": true,
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "0px 0px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  return (entity?.state === 'on')\n    ? 'linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.06))'\n    : 'linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))';\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n\" \"i l\""
                          },
                          {
                            "grid-template-columns": "28px 1fr"
                          },
                          {
                            "row-gap": "2px"
                          }
                        ],
                        "icon": [
                          {
                            "width": "22px"
                          },
                          {
                            "color": "[[[\n  return (entity?.state === 'on') ? '#ef4444' : '#0ea5e9';\n]]]\n"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "end"
                          },
                          {
                            "font-weight": 700
                          },
                          {
                            "font-size": ".82rem"
                          }
                        ],
                        "label": [
                          {
                            "align-self": "start"
                          },
                          {
                            "font-size": "1rem"
                          },
                          {
                            "opacity": 0.9
                          }
                        ]
                      },
                      "tap_action": {
                        "action": "toggle"
                      }
                    },
                    {
                      "type": "custom:button-card",
                      "entity": "switch.ordi_moniteur",
                      "name": "Hi-fi &",
                      "label": "écran",
                      "icon": "mdi:monitor-speaker",
                      "show_state": false,
                      "show_label": true,
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "6px 8px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  return (entity?.state === 'on')\n    ? 'linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.06))'\n    : 'linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))';\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n\" \"i l\""
                          },
                          {
                            "grid-template-columns": "28px 1fr"
                          },
                          {
                            "row-gap": "2px"
                          }
                        ],
                        "icon": [
                          {
                            "width": "22px"
                          },
                          {
                            "color": "[[[\n  return (entity?.state === 'on') ? '#ef4444' : '#0ea5e9';\n]]]\n"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "end"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          }
                        ],
                        "label": [
                          {
                            "align-self": "start"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          },
                          {
                            "opacity": 0.95
                          }
                        ]
                      },
                      "tap_action": {
                        "action": "toggle"
                      }
                    },
                    {
                      "type": "custom:button-card",
                      "entity": "switch.0x08ddebfffed9ed45",
                      "name": "Atelier",
                      "icon": "mdi:lightbulb",
                      "show_state": false,
                      "show_label": true,
                      "label": "[[[\n  const v = states['sensor.thermo_garage_temperature']?.state;\n  if (!v || v === 'unknown' || v === 'unavailable') return '—';\n  const n = Number(v);\n  return isNaN(n) ? v : `${n.toFixed(1)}°C`;\n]]]\n",
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "6px 8px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  return (entity?.state === 'on')\n    ? 'linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.06))'\n    : 'linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))';\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n\" \"i l\""
                          },
                          {
                            "grid-template-columns": "28px 1fr"
                          },
                          {
                            "grid-template-rows": "auto auto"
                          }
                        ],
                        "icon": [
                          {
                            "width": "22px"
                          },
                          {
                            "color": "[[[\n  return (entity?.state === 'on') ? '#facc15' : '#0ea5e9';\n]]]\n"
                          },
                          {
                            "filter": "[[[\n  return (entity?.state === 'on')\n    ? 'drop-shadow(0 0 6px rgba(250,204,21,.75)) saturate(120%)'\n    : 'none';\n]]]\n"
                          },
                          {
                            "transition": "filter .2s ease, color .2s ease"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "end"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          },
                          {
                            "line-height": 1.05
                          }
                        ],
                        "label": [
                          {
                            "align-self": "start"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          },
                          {
                            "line-height": 1.05
                          }
                        ]
                      },
                      "tap_action": {
                        "action": "toggle"
                      }
                    }
                  ]
                },
                {
                  "type": "custom:layout-card",
                  "layout_type": "grid",
                  "layout": {
                    "grid-template-columns": "repeat(3, 1fr)",
                    "column-gap": "4px",
                    "row-gap": "4px"
                  },
                  "cards": [
                    {
                      "type": "custom:button-card",
                      "entity": "switch.shellypro1_ece334ee1b64",
                      "name": "Cumulus",
                      "icon": "mdi:water-boiler",
                      "show_state": false,
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "6px 8px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  return (entity?.state === 'on')\n    ? 'linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.06))'\n    : 'linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))';\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n\""
                          },
                          {
                            "grid-template-columns": "28px 1fr"
                          }
                        ],
                        "icon": [
                          {
                            "width": "28px"
                          },
                          {
                            "color": "[[[\n  return (entity?.state === 'on') ? '#ef4444' : '#0ea5e9';\n]]]\n"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "center"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          }
                        ]
                      },
                      "tap_action": {
                        "action": "toggle"
                      }
                    },
                    {
                      "type": "custom:button-card",
                      "entity": "sensor.iphone_isa_battery_level",
                      "name": "iPhone",
                      "icon": "mdi:cellphone",
                      "show_state": false,
                      "show_label": false,
                      "custom_fields": {
                        "pct": "[[[\n  const v = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  return `${v.toFixed(0)} %`;\n]]]\n",
                        "bar": "[[[\n  const lvl = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  const hue = Math.round(lvl * 1.2); // 0→120 (rouge→vert)\n  const color = `hsl(${hue}, 85%, 45%)`;\n  return `\n    <div style=\"height:4px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${lvl}%;background:${color}\"></div>\n    </div>`;\n]]]\n"
                      },
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "6px 8px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  const lvl = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  const hue = Math.round(lvl * 1.2);\n  const c1 = `hsla(${hue}, 85%, 60%, .16)`;\n  const c2 = `hsla(${hue}, 85%, 60%, .08)`;\n  return `linear-gradient(135deg, ${c1}, ${c2})`;\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n pct\" \"bar bar bar\""
                          },
                          {
                            "grid-template-columns": "20px 1fr auto"
                          },
                          {
                            "grid-template-rows": "auto 4px"
                          },
                          {
                            "row-gap": "4px"
                          }
                        ],
                        "icon": [
                          {
                            "width": "14px"
                          },
                          {
                            "color": "#0ea5e9"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "center"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          }
                        ],
                        "custom_fields": {
                          "pct": [
                            {
                              "grid-area": "pct"
                            },
                            {
                              "align-self": "center"
                            },
                            {
                              "justify-self": "end"
                            },
                            {
                              "font-size": ".9rem"
                            },
                            {
                              "opacity": 0.95
                            }
                          ],
                          "bar": [
                            {
                              "grid-area": "bar"
                            },
                            {
                              "align-self": "end"
                            }
                          ]
                        }
                      },
                      "tap_action": {
                        "action": "more-info"
                      },
                      "triggers_update": [
                        "sensor.iphone_isa_battery_level"
                      ]
                    },
                    {
                      "type": "custom:button-card",
                      "entity": "sensor.ipad_de_isabelle_battery_level",
                      "name": "iPad Air",
                      "icon": "mdi:tablet",
                      "show_state": false,
                      "show_label": false,
                      "custom_fields": {
                        "pct": "[[[\n  const v = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  return `${v.toFixed(0)} %`;\n]]]\n",
                        "bar": "[[[\n  const lvl = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  const hue = Math.round(lvl * 1.2);\n  const color = `hsl(${hue}, 85%, 45%)`;\n  return `\n    <div style=\"height:4px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${lvl}%;background:${color}\"></div>\n    </div>`;\n]]]\n"
                      },
                      "styles": {
                        "card": [
                          {
                            "min-height": "52px"
                          },
                          {
                            "border-radius": "12px"
                          },
                          {
                            "padding": "6px 8px"
                          },
                          {
                            "box-shadow": "0 1px 6px rgba(0,0,0,.12)"
                          },
                          {
                            "background": "[[[\n  const lvl = Math.max(0, Math.min(100, Number(entity?.state) || 0));\n  const hue = Math.round(lvl * 1.2);\n  const c1 = `hsla(${hue}, 85%, 60%, .16)`;\n  const c2 = `hsla(${hue}, 85%, 60%, .08)`;\n  return `linear-gradient(135deg, ${c1}, ${c2})`;\n]]]\n"
                          }
                        ],
                        "grid": [
                          {
                            "grid-template-areas": "\"i n pct\" \"bar bar bar\""
                          },
                          {
                            "grid-template-columns": "20px 1fr auto"
                          },
                          {
                            "grid-template-rows": "auto 4px"
                          },
                          {
                            "row-gap": "4px"
                          }
                        ],
                        "icon": [
                          {
                            "width": "24px"
                          },
                          {
                            "color": "#0ea5e9"
                          }
                        ],
                        "name": [
                          {
                            "align-self": "center"
                          },
                          {
                            "font-weight": 600
                          },
                          {
                            "font-size": ".92rem"
                          }
                        ],
                        "custom_fields": {
                          "pct": [
                            {
                              "grid-area": "pct"
                            },
                            {
                              "align-self": "center"
                            },
                            {
                              "justify-self": "end"
                            },
                            {
                              "font-size": ".9rem"
                            },
                            {
                              "opacity": 0.95
                            }
                          ],
                          "bar": [
                            {
                              "grid-area": "bar"
                            },
                            {
                              "align-self": "end"
                            }
                          ]
                        }
                      },
                      "tap_action": {
                        "action": "more-info"
                      },
                      "triggers_update": [
                        "sensor.ipad_de_isabelle_battery_level"
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "custom:button-card",
              "variables": {
                "printer_state": "switch.imprimante_epson",
                "c_state": "sensor.epson_et_2870_cyan_ink_cached",
                "y_state": "sensor.epson_et_2870_yellow_ink_cached",
                "m_state": "sensor.epson_et_2870_magenta_ink_cached",
                "b_state": "sensor.epson_et_2870_black_ink_cached"
              },
              "triggers_update": [
                "switch.imprimante_epson",
                "sensor.epson_et_2870_black_ink_cached",
                "sensor.epson_et_2870_cyan_ink_cached",
                "sensor.epson_et_2870_magenta_ink_cached",
                "sensor.epson_et_2870_yellow_ink_cached"
              ],
              "show_name": false,
              "show_state": false,
              "show_icon": false,
              "styles": {
                "card": [
                  {
                    "padding": "3px"
                  },
                  {
                    "border-radius": "14px"
                  },
                  {
                    "background": "linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))"
                  },
                  {
                    "box-shadow": "0 2px 10px rgba(0,0,0,.12)"
                  },
                  {
                    "overflow": "hidden"
                  }
                ],
                "grid": [
                  {
                    "grid-template-areas": "\"haut bas\""
                  },
                  {
                    "grid-template-columns": "4fr 5fr"
                  },
                  {
                    "grid-template-rows": "100%"
                  }
                ],
                "custom_fields": {
                  "haut": [
                    {
                      "filter": "opacity(100%)"
                    },
                    {
                      "overflow": "visible"
                    }
                  ],
                  "bas": [
                    {
                      "filter": "opacity(100%)"
                    },
                    {
                      "overflow": "visible"
                    }
                  ]
                }
              },
              "custom_fields": {
                "haut": {
                  "card": {
                    "type": "custom:mushroom-entity-card",
                    "entity": "[[[ return variables.printer_state ]]]",
                    "tap_action": {
                      "action": "toggle"
                    },
                    "icon": "mdi:printer",
                    "card_mod": {
                      "style": "ha-card {\n  padding: 0 !important;\n  padding-bottom: 1px !important;\n  text-align: left !important;\n  border: none !important;\n  box-shadow: none !important;\n  background: transparent !important;\n}\n"
                    }
                  }
                },
                "bas": {
                  "card": {
                    "type": "grid",
                    "columns": 4,
                    "square": false,
                    "cards": [
                      {
                        "type": "custom:button-card",
                        "entity": "[[[ return variables.b_state ]]]",
                        "show_name": false,
                        "show_state": true,
                        "show_label": false,
                        "show_icon": false,
                        "size": "100%",
                        "styles": {
                          "grid": [
                            {
                              "grid-template-areas": "\"s\""
                            },
                            {
                              "grid-template-columns": "100%"
                            },
                            {
                              "grid-template-rows": "100%"
                            }
                          ],
                          "state": [
                            {
                              "font-size": "1rem"
                            },
                            {
                              "font-weight": 800
                            },
                            {
                              "color": "var(--primary-text-color)"
                            },
                            {
                              "text-shadow": "0 1px 0 rgba(255,255,255,.6), 0 0 2px rgba(0,0,0,.28)"
                            }
                          ],
                          "card": [
                            {
                              "height": "3rem"
                            },
                            {
                              "border-radius": "14px"
                            },
                            {
                              "box-shadow": "inset 0 0 0 1px rgba(255,255,255,.25), 0 2px 8px rgba(0,0,0,.10)"
                            },
                            {
                              "background": "[[[\n  const v = Math.max(0, Math.min(100, Number(states[variables.b_state].state)||0));\n  const fill = `linear-gradient(to top,\n    rgba(150,150,150,.55) 0%,\n    rgba(150,150,150,.55) ${v}%,\n    rgba(150,150,150,.06) ${v}%,\n    rgba(150,150,150,.06) 100%)`;\n  const track = 'linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.18))';\n  const gloss = 'linear-gradient(180deg, rgba(255,255,255,.18) 0%, rgba(255,255,255,0) 40%)';\n  const theme = 'linear-gradient(135deg, rgba(148,163,184,.20), rgba(6,182,212,.10))';\n  return `${gloss}, ${fill}, ${track}, ${theme}`;\n]]]\n"
                            }
                          ]
                        },
                        "state_display": "[[[ return Math.round(Number(states[variables.b_state].state)) + states[variables.b_state].attributes.unit_of_measurement; ]]]\n"
                      },
                      {
                        "type": "custom:button-card",
                        "entity": "[[[ return variables.c_state ]]]",
                        "show_name": false,
                        "show_state": true,
                        "show_label": false,
                        "show_icon": false,
                        "size": "100%",
                        "styles": {
                          "grid": [
                            {
                              "grid-template-areas": "\"s\""
                            },
                            {
                              "grid-template-columns": "100%"
                            },
                            {
                              "grid-template-rows": "100%"
                            }
                          ],
                          "state": [
                            {
                              "font-size": "1rem"
                            },
                            {
                              "font-weight": 800
                            },
                            {
                              "color": "darkcyan"
                            },
                            {
                              "text-shadow": "0 1px 0 rgba(255,255,255,.6), 0 0 2px rgba(0,0,0,.28)"
                            }
                          ],
                          "card": [
                            {
                              "height": "3rem"
                            },
                            {
                              "border-radius": "14px"
                            },
                            {
                              "box-shadow": "inset 0 0 0 1px rgba(255,255,255,.25), 0 2px 8px rgba(0,0,0,.10)"
                            },
                            {
                              "background": "[[[\n  const v = Math.max(0, Math.min(100, Number(states[variables.c_state].state)||0));\n  const fill = `linear-gradient(to top,\n    rgba(0,139,139,.50) 0%,\n    rgba(0,139,139,.50) ${v}%,\n    rgba(0,139,139,.08) ${v}%,\n    rgba(0,139,139,.08) 100%)`;\n  const track = 'linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.18))';\n  const gloss = 'linear-gradient(180deg, rgba(255,255,255,.18) 0%, rgba(255,255,255,0) 40%)';\n  const theme = 'linear-gradient(135deg, rgba(6,182,212,.18), rgba(6,182,212,.10))';\n  return `${gloss}, ${fill}, ${track}, ${theme}`;\n]]]\n"
                            }
                          ]
                        },
                        "state_display": "[[[ return Math.round(Number(states[variables.c_state].state)) + states[variables.c_state].attributes.unit_of_measurement; ]]]\n"
                      },
                      {
                        "type": "custom:button-card",
                        "entity": "[[[ return variables.m_state ]]]",
                        "show_name": false,
                        "show_state": true,
                        "show_label": false,
                        "show_icon": false,
                        "size": "100%",
                        "styles": {
                          "grid": [
                            {
                              "grid-template-areas": "\"s\""
                            },
                            {
                              "grid-template-columns": "100%"
                            },
                            {
                              "grid-template-rows": "100%"
                            }
                          ],
                          "state": [
                            {
                              "font-size": "1rem"
                            },
                            {
                              "font-weight": 800
                            },
                            {
                              "color": "magenta"
                            },
                            {
                              "text-shadow": "0 1px 0 rgba(255,255,255,.6), 0 0 2px rgba(0,0,0,.28)"
                            }
                          ],
                          "card": [
                            {
                              "height": "3rem"
                            },
                            {
                              "border-radius": "14px"
                            },
                            {
                              "box-shadow": "inset 0 0 0 1px rgba(255,255,255,.25), 0 2px 8px rgba(0,0,0,.10)"
                            },
                            {
                              "background": "[[[\n  const v = Math.max(0, Math.min(100, Number(states[variables.m_state].state)||0));\n  const fill = `linear-gradient(to top,\n    rgba(255,0,255,.50) 0%,\n    rgba(255,0,255,.50) ${v}%,\n    rgba(255,0,255,.08) ${v}%,\n    rgba(255,0,255,.08) 100%)`;\n  const track = 'linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.18))';\n  const gloss = 'linear-gradient(180deg, rgba(255,255,255,.18) 0%, rgba(255,255,255,0) 40%)';\n  const theme = 'linear-gradient(135deg, rgba(236,72,153,.20), rgba(6,182,212,.10))';\n  return `${gloss}, ${fill}, ${track}, ${theme}`;\n]]]\n"
                            }
                          ]
                        },
                        "state_display": "[[[ return Math.round(Number(states[variables.m_state].state)) + states[variables.m_state].attributes.unit_of_measurement; ]]]\n"
                      },
                      {
                        "type": "custom:button-card",
                        "entity": "[[[ return variables.y_state ]]]",
                        "show_name": false,
                        "show_state": true,
                        "show_label": false,
                        "show_icon": false,
                        "size": "100%",
                        "styles": {
                          "grid": [
                            {
                              "grid-template-areas": "\"s\""
                            },
                            {
                              "grid-template-columns": "100%"
                            },
                            {
                              "grid-template-rows": "100%"
                            }
                          ],
                          "state": [
                            {
                              "font-size": "1rem"
                            },
                            {
                              "font-weight": 800
                            },
                            {
                              "color": "darkorange"
                            },
                            {
                              "text-shadow": "0 1px 0 rgba(255,255,255,.6), 0 0 2px rgba(0,0,0,.28)"
                            }
                          ],
                          "card": [
                            {
                              "height": "3rem"
                            },
                            {
                              "border-radius": "14px"
                            },
                            {
                              "box-shadow": "inset 0 0 0 1px rgba(255,255,255,.25), 0 2px 8px rgba(0,0,0,.10)"
                            },
                            {
                              "background": "[[[\n  const v = Math.max(0, Math.min(100, Number(states[variables.y_state].state)||0));\n  const fill = `linear-gradient(to top,\n    rgba(255,140,0,.52) 0%,\n    rgba(255,140,0,.52) ${v}%,\n    rgba(255,140,0,.10) ${v}%,\n    rgba(255,140,0,.10) 100%)`;\n  const track = 'linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.18))';\n  const gloss = 'linear-gradient(180deg, rgba(255,255,255,.18) 0%, rgba(255,255,255,0) 40%)';\n  const theme = 'linear-gradient(135deg, rgba(234,179,8,.22), rgba(6,182,212,.10))';\n  return `${gloss}, ${fill}, ${track}, ${theme}`;\n]]]\n"
                            }
                          ]
                        },
                        "state_display": "[[[ return Math.round(Number(states[variables.y_state].state)) + states[variables.y_state].attributes.unit_of_measurement; ]]]\n"
                      }
                    ]
                  }
                }
              }
            },
            {
              "type": "custom:layout-card",
              "layout_type": "grid",
              "layout": {
                "grid-template-columns": "1fr 56px 56px 56px",
                "column-gap": "8px",
                "row-gap": "2px"
              },
              "cards": [
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_salon",
                  "name": "Salon",
                  "show_state": false,
                  "show_icon": true,
                  "custom_fields": {
                    "bar": "[[[\n  const a = entity?.attributes || {};\n  const raw = (a.current_position ?? a.position ?? null);\n  let openPct = (raw === null || raw === undefined)\n    ? ((entity?.state === 'open') ? 100 : (entity?.state === 'closed') ? 0 : 0)\n    : Number(raw);\n  const pctClosed = Math.max(0, Math.min(100, isFinite(openPct) ? (100 - openPct) : 0));\n  return `\n    <div style=\"height:3px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${pctClosed}%;background:linear-gradient(90deg,#6366f1,#22c55e)\"></div>\n    </div>`;\n]]]\n"
                  },
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "padding": "4px 6px 6px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(99,102,241,.12), rgba(6,182,212,.06))"
                      },
                      {
                        "box-shadow": "0 1px 6px rgba(0,0,0,.10)"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"i n\" \"bar bar\""
                      },
                      {
                        "grid-template-columns": "32px 1fr"
                      },
                      {
                        "grid-template-rows": "auto 3px"
                      },
                      {
                        "row-gap": "2px"
                      }
                    ],
                    "name": [
                      {
                        "align-self": "center"
                      },
                      {
                        "font-weight": 600
                      },
                      {
                        "font-size": ".90rem"
                      },
                      {
                        "line-height": 1.05
                      }
                    ],
                    "icon": [
                      {
                        "width": "22px"
                      },
                      {
                        "color": "#6366f1"
                      }
                    ],
                    "custom_fields": {
                      "bar": [
                        {
                          "align-self": "end"
                        }
                      ]
                    }
                  },
                  "tap_action": {
                    "action": "none"
                  },
                  "triggers_update": "all"
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_salon",
                  "icon": "mdi:arrow-up",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(34,197,94,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(34,197,94,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.open_cover",
                    "data": {
                      "entity_id": "cover.wifi_salon"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_salon",
                  "icon": "mdi:stop",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(148,163,184,.16), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(100,116,139,.95)"
                      },
                      {
                        "width": "18px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.stop_cover",
                    "data": {
                      "entity_id": "cover.wifi_salon"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_salon",
                  "icon": "mdi:arrow-down",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(239,68,68,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.close_cover",
                    "data": {
                      "entity_id": "cover.wifi_salon"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_sam",
                  "name": "Salle à manger",
                  "show_state": false,
                  "show_icon": true,
                  "custom_fields": {
                    "bar": "[[[\n  const a = entity?.attributes || {};\n  const raw = (a.current_position ?? a.position ?? null);\n  let openPct = (raw === null || raw === undefined)\n    ? ((entity?.state === 'open') ? 100 : (entity?.state === 'closed') ? 0 : 0)\n    : Number(raw);\n  const pctClosed = Math.max(0, Math.min(100, isFinite(openPct) ? (100 - openPct) : 0));\n  return `\n    <div style=\"height:3px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${pctClosed}%;background:linear-gradient(90deg,#6366f1,#22c55e)\"></div>\n    </div>`;\n]]]\n"
                  },
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "padding": "4px 6px 6px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(99,102,241,.12), rgba(6,182,212,.06))"
                      },
                      {
                        "box-shadow": "0 1px 6px rgba(0,0,0,.10)"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"i n\" \"bar bar\""
                      },
                      {
                        "grid-template-columns": "32px 1fr"
                      },
                      {
                        "grid-template-rows": "auto 3px"
                      },
                      {
                        "row-gap": "2px"
                      }
                    ],
                    "name": [
                      {
                        "align-self": "center"
                      },
                      {
                        "font-weight": 600
                      },
                      {
                        "font-size": ".90rem"
                      },
                      {
                        "line-height": 1.05
                      }
                    ],
                    "icon": [
                      {
                        "width": "22px"
                      },
                      {
                        "color": "#6366f1"
                      }
                    ],
                    "custom_fields": {
                      "bar": [
                        {
                          "align-self": "end"
                        }
                      ]
                    }
                  },
                  "tap_action": {
                    "action": "none"
                  },
                  "triggers_update": "all"
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_sam",
                  "icon": "mdi:arrow-up",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(34,197,94,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(34,197,94,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.open_cover",
                    "data": {
                      "entity_id": "cover.wifi_sam"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_sam",
                  "icon": "mdi:stop",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(148,163,184,.16), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(100,116,139,.95)"
                      },
                      {
                        "width": "18px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.stop_cover",
                    "data": {
                      "entity_id": "cover.wifi_sam"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_sam",
                  "icon": "mdi:arrow-down",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(239,68,68,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.close_cover",
                    "data": {
                      "entity_id": "cover.wifi_sam"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_ch_amis",
                  "name": "Ch. d’amis",
                  "show_state": false,
                  "show_icon": true,
                  "custom_fields": {
                    "bar": "[[[\n  const a = entity?.attributes || {};\n  const raw = (a.current_position ?? a.position ?? null);\n  let openPct = (raw === null || raw === undefined)\n    ? ((entity?.state === 'open') ? 100 : (entity?.state === 'closed') ? 0 : 0)\n    : Number(raw);\n  const pctClosed = Math.max(0, Math.min(100, isFinite(openPct) ? (100 - openPct) : 0));\n  return `\n    <div style=\"height:3px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${pctClosed}%;background:linear-gradient(90deg,#06b6d4,#22c55e)\"></div>\n    </div>`;\n]]]\n"
                  },
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "padding": "4px 6px 6px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))"
                      },
                      {
                        "box-shadow": "0 1px 6px rgba(0,0,0,.10)"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"i n\" \"bar bar\""
                      },
                      {
                        "grid-template-columns": "32px 1fr"
                      },
                      {
                        "grid-template-rows": "auto 3px"
                      },
                      {
                        "row-gap": "2px"
                      }
                    ],
                    "name": [
                      {
                        "align-self": "center"
                      },
                      {
                        "font-weight": 600
                      },
                      {
                        "font-size": ".90rem"
                      },
                      {
                        "line-height": 1.05
                      }
                    ],
                    "icon": [
                      {
                        "width": "22px"
                      },
                      {
                        "color": "#06b6d4"
                      }
                    ],
                    "custom_fields": {
                      "bar": [
                        {
                          "grid-area": "bar"
                        },
                        {
                          "align-self": "end"
                        }
                      ]
                    }
                  },
                  "tap_action": {
                    "action": "none"
                  },
                  "triggers_update": "all"
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_ch_amis",
                  "icon": "mdi:arrow-up",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(34,197,94,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(34,197,94,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.open_cover",
                    "data": {
                      "entity_id": "cover.wifi_ch_amis"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_ch_amis",
                  "icon": "mdi:stop",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(148,163,184,.16), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(100,116,139,.95)"
                      },
                      {
                        "width": "18px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.stop_cover",
                    "data": {
                      "entity_id": "cover.wifi_ch_amis"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_ch_amis",
                  "icon": "mdi:arrow-down",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(239,68,68,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.close_cover",
                    "data": {
                      "entity_id": "cover.wifi_ch_amis"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_parents",
                  "name": "Parents",
                  "show_state": false,
                  "show_icon": true,
                  "custom_fields": {
                    "bar": "[[[\n  const a = entity?.attributes || {};\n  const raw = (a.current_position ?? a.position ?? null);\n  let openPct = (raw === null || raw === undefined)\n    ? ((entity?.state === 'open') ? 100 : (entity?.state === 'closed') ? 0 : 0)\n    : Number(raw);\n  const pctClosed = Math.max(0, Math.min(100, isFinite(openPct) ? (100 - openPct) : 0));\n  return `\n    <div style=\"height:3px;width:100%;background:var(--ha-card-background,#e6e9ef);border-radius:3px;overflow:hidden\">\n      <div style=\"height:100%;width:${pctClosed}%;background:linear-gradient(90deg,#06b6d4,#22c55e)\"></div>\n    </div>`;\n]]]\n"
                  },
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "padding": "4px 6px 6px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(6,182,212,.10), rgba(6,182,212,.05))"
                      },
                      {
                        "box-shadow": "0 1px 6px rgba(0,0,0,.10)"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"i n\" \"bar bar\""
                      },
                      {
                        "grid-template-columns": "32px 1fr"
                      },
                      {
                        "grid-template-rows": "auto 3px"
                      },
                      {
                        "row-gap": "2px"
                      }
                    ],
                    "name": [
                      {
                        "align-self": "center"
                      },
                      {
                        "font-weight": 600
                      },
                      {
                        "font-size": ".90rem"
                      },
                      {
                        "line-height": 1.05
                      }
                    ],
                    "icon": [
                      {
                        "width": "22px"
                      },
                      {
                        "color": "#06b6d4"
                      }
                    ],
                    "custom_fields": {
                      "bar": [
                        {
                          "grid-area": "bar"
                        },
                        {
                          "align-self": "end"
                        }
                      ]
                    }
                  },
                  "tap_action": {
                    "action": "none"
                  },
                  "triggers_update": "all"
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_parents",
                  "icon": "mdi:arrow-up",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(34,197,94,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(34,197,94,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.open_cover",
                    "data": {
                      "entity_id": "cover.wifi_parents"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_parents",
                  "icon": "mdi:stop",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(148,163,184,.16), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(100,116,139,.95)"
                      },
                      {
                        "width": "18px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.stop_cover",
                    "data": {
                      "entity_id": "cover.wifi_parents"
                    }
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "cover.wifi_parents",
                  "icon": "mdi:arrow-down",
                  "show_name": false,
                  "show_state": false,
                  "show_icon": true,
                  "styles": {
                    "card": [
                      {
                        "min-height": "44px"
                      },
                      {
                        "padding": 0
                      },
                      {
                        "display": "grid"
                      },
                      {
                        "place-items": "center"
                      },
                      {
                        "border-radius": "12px"
                      },
                      {
                        "background": "linear-gradient(135deg, rgba(239,68,68,.14), rgba(6,182,212,.08))"
                      },
                      {
                        "box-shadow": "0 1px 5px rgba(0,0,0,.10)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "rgba(239,68,68,.95)"
                      },
                      {
                        "width": "20px"
                      }
                    ]
                  },
                  "tap_action": {
                    "action": "call-service",
                    "service": "cover.close_cover",
                    "data": {
                      "entity_id": "cover.wifi_parents"
                    }
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "masonry",
          "path": "Prod Solaire",
          "title": "Solaire",
          "icon": "mdi:solar-power-variant",
          "cards": [
            {
              "type": "picture-elements",
              "image": "https://www.monchauffageelectrique.com/wp-content/uploads/2019/06/panneaux-solaires-photovoltaiques.jpg",
              "elements": [
                {
                  "type": "state-label",
                  "entity": "sensor.dashboard_titre_photovoltaique",
                  "style": {
                    "top": "10%",
                    "left": "50%",
                    "transform": "translateX(-50%)",
                    "color": "white",
                    "font-size": "24px",
                    "font-weight": "bold",
                    "text-shadow": "2px 2px 4px rgba(0,0,0,0.8)",
                    "background": "rgba(0,0,0,0.4)",
                    "padding": "6px 12px",
                    "border-radius": "8px"
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "sensor.savings_day_eur",
                  "name": "Aujourd’hui",
                  "icon": "mdi:calendar-today",
                  "layout": "icon_state",
                  "show_icon": false,
                  "show_state": true,
                  "state_display": "[[[\n  const v = Number(entity.state);\n  return isNaN(v) ? '—' :\n    v.toLocaleString('fr-FR',{minimumFractionDigits:2, maximumFractionDigits:2}) + ' €';\n]]]\n",
                  "styles": {
                    "card": [
                      {
                        "width": "100px"
                      },
                      {
                        "height": "100px"
                      },
                      {
                        "border-radius": "50%"
                      },
                      {
                        "background": "rgba(33,150,243,0.85)"
                      },
                      {
                        "box-shadow": "0 4px 10px rgba(0,0,0,0.6)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "#ffeb3b"
                      },
                      {
                        "width": "32px"
                      },
                      {
                        "height": "32px"
                      }
                    ],
                    "state": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "font-weight": "bold"
                      },
                      {
                        "margin-right": "35px"
                      }
                    ],
                    "name": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "margin-bottom": "10px"
                      }
                    ]
                  },
                  "style": {
                    "top": "60%",
                    "left": "14%",
                    "transform": "translate(-50%, -50%)"
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "sensor.savings_month_eur",
                  "name": "Mensuel",
                  "icon": "mdi:calendar-month",
                  "layout": "icon_state",
                  "show_icon": false,
                  "show_state": true,
                  "state_display": "[[[\n  const v = Number(entity.state);\n  return isNaN(v) ? '—' :\n    v.toLocaleString('fr-FR',{minimumFractionDigits:2, maximumFractionDigits:2}) + ' €';\n]]]\n",
                  "styles": {
                    "card": [
                      {
                        "width": "100px"
                      },
                      {
                        "height": "100px"
                      },
                      {
                        "border-radius": "50%"
                      },
                      {
                        "background": "rgba(76,175,80,0.85)"
                      },
                      {
                        "box-shadow": "0 4px 10px rgba(0,0,0,0.6)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "white"
                      },
                      {
                        "width": "32px"
                      },
                      {
                        "height": "32px"
                      }
                    ],
                    "state": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "font-weight": "bold"
                      },
                      {
                        "margin-right": "35px"
                      }
                    ],
                    "name": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "margin-bottom": "10px"
                      }
                    ]
                  },
                  "style": {
                    "top": "60%",
                    "left": "38%",
                    "transform": "translate(-50%, -50%)"
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "sensor.savings_total_eur_with_baseline",
                  "name": "Annuel",
                  "icon": "mdi:chart-box-outline",
                  "layout": "icon_state",
                  "show_icon": false,
                  "show_state": true,
                  "state_display": "[[[\n  const v = Number(entity.state);\n  return isNaN(v) ? '—' :\n    v.toLocaleString('fr-FR',{minimumFractionDigits:2, maximumFractionDigits:2}) + ' €';\n]]]\n",
                  "styles": {
                    "card": [
                      {
                        "width": "100px"
                      },
                      {
                        "height": "100px"
                      },
                      {
                        "border-radius": "50%"
                      },
                      {
                        "background": "rgba(255,165,40,0.8)"
                      },
                      {
                        "box-shadow": "0 4px 10px rgba(0,0,0,0.6)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "white"
                      },
                      {
                        "width": "32px"
                      },
                      {
                        "height": "32px"
                      }
                    ],
                    "state": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "14px"
                      },
                      {
                        "font-weight": "bold"
                      },
                      {
                        "margin-right": "35px"
                      }
                    ],
                    "name": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "margin-top": "0px"
                      },
                      {
                        "margin-bottom": "10px"
                      }
                    ]
                  },
                  "style": {
                    "top": "60%",
                    "left": "62%",
                    "transform": "translate(-50%, -50%)"
                  }
                },
                {
                  "type": "custom:button-card",
                  "entity": "sensor.savings_total_eur_with_baseline",
                  "name": "Total",
                  "icon": "mdi:chart-box-outline",
                  "layout": "icon_state",
                  "show_icon": false,
                  "show_state": true,
                  "state_display": "[[[\n  const v = Number(entity.state);\n  return isNaN(v) ? '—' :\n    v.toLocaleString('fr-FR',{minimumFractionDigits:2, maximumFractionDigits:2}) + ' €';\n]]]\n",
                  "styles": {
                    "card": [
                      {
                        "width": "100px"
                      },
                      {
                        "height": "100px"
                      },
                      {
                        "border-radius": "50%"
                      },
                      {
                        "background": "rgba(244,67,54,0.85)"
                      },
                      {
                        "box-shadow": "0 4px 10px rgba(0,0,0,0.6)"
                      }
                    ],
                    "icon": [
                      {
                        "color": "white"
                      },
                      {
                        "width": "32px"
                      },
                      {
                        "height": "32px"
                      }
                    ],
                    "state": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "14px"
                      },
                      {
                        "font-weight": "bold"
                      },
                      {
                        "margin-right": "35px"
                      }
                    ],
                    "name": [
                      {
                        "color": "white"
                      },
                      {
                        "font-size": "16px"
                      },
                      {
                        "margin-top": "0px"
                      },
                      {
                        "margin-bottom": "10px"
                      }
                    ]
                  },
                  "style": {
                    "top": "60%",
                    "left": "86%",
                    "transform": "translate(-50%, -50%)"
                  }
                }
              ]
            },
            {
              "type": "horizontal-stack",
              "cards": [
                {
                  "type": "custom:button-card",
                  "show_name": false,
                  "show_state": false,
                  "styles": {
                    "card": [
                      {
                        "padding": "6px"
                      },
                      {
                        "border-radius": "16px"
                      },
                      {
                        "--ring-max": "280px"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"title\" \"pie\""
                      },
                      {
                        "grid-template-rows": "auto 1fr"
                      },
                      {
                        "grid-template-columns": "1fr"
                      }
                    ],
                    "custom_fields": {
                      "title": [
                        {
                          "justify-self": "start"
                        },
                        {
                          "font-weight": 600
                        },
                        {
                          "font-size": "1rem"
                        },
                        {
                          "padding": "0 2px 4px"
                        }
                      ],
                      "pie": [
                        {
                          "width": "100%"
                        },
                        {
                          "max-width": "var(--ring-max)"
                        },
                        {
                          "aspect-ratio": "1 / 1"
                        },
                        {
                          "margin": "0 auto"
                        },
                        {
                          "justify-self": "center"
                        }
                      ]
                    }
                  },
                  "custom_fields": {
                    "title": "Énergie d’aujourd’hui",
                    "pie": "[[[\n  // Données\n  const idSolar='sensor.energie_autoconsommee_2';\n  const idEDF='sensor.import_edf_quotidien';\n  const idSurplus='sensor.export_daily_2';\n  const v=id=>Number(states[id]?.state)||0;\n  const solar=v(idSolar), edf=v(idEDF), surp=v(idSurplus);\n  const sum = solar+edf+surp;\n\n  // Couleurs\n  const cSolar='#ffd700', cEDF='#0074D9', cSurp='#ff4136';\n  const cGrey = getComputedStyle(document.documentElement).getPropertyValue('--disabled-color') || '#c8c8c8';\n\n  // Géométrie fixe dans le viewBox (elle s'agrandit/retrécit avec width:100%)\n  const S=200, cx=100, cy=100, r=76, stroke=32;  // Ø≈200 ; épaisseur relative (32/200)\n  const C=2*Math.PI*r, gap=2;\n  const fmt = x => (x>=1 ? Math.round(x) : Math.round(x*10)/10).toLocaleString('fr-FR');\n\n  // Taille de police responsive (en fonction de la largeur réelle de la carte)\n  const sizePx = this.offsetWidth || 220;\n  const f = (min, k, max)=>Math.max(min, Math.min(max, sizePx*k));\n  const fs = {\n    line:  f(12, .045, 16)  // 12–16 px\n  };\n\n  const centerLegend = (svg) => `\n    <div style=\"position:relative;width:100%;height:100%;\">\n      ${svg}\n      <div style=\"position:absolute;inset:0;display:grid;place-items:center;\">\n        <div style=\"text-align:center;line-height:1;display:flex;flex-direction:column;gap:2px;font-size:${fs.line}px\">\n          <div style=\"white-space:nowrap;\">\n            <span style=\"display:inline-block;width:10px;height:10px;border-radius:50%;background:${cSolar};margin-right:6px;\"></span>\n            Solaire <b>${fmt(solar)}</b> kWh\n          </div>\n          <div style=\"white-space:nowrap;\">\n            <span style=\"display:inline-block;width:10px;height:10px;border-radius:50%;background:${cEDF};margin-right:6px;\"></span>\n            EDF <b>${fmt(edf)}</b> kWh\n          </div>\n          <div style=\"white-space:nowrap;\">\n            <span style=\"display:inline-block;width:10px;height:10px;border-radius:50%;background:${cSurp};margin-right:6px;\"></span>\n            Surplus <b>${fmt(surp)}</b> kWh\n          </div>\n        </div>\n      </div>\n    </div>`;\n\n  if (sum <= 0.00001) {\n    const svg = `\n      <svg viewBox=\"0 0 ${S} ${S}\" width=\"100%\" height=\"100%\">\n        <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"white\" stroke-width=\"${stroke}\"></circle>\n        <g transform=\"rotate(-90 ${cx} ${cy})\">\n          <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${cGrey}\" stroke-width=\"${stroke}\"></circle>\n        </g>\n      </svg>`;\n    return centerLegend(svg);\n  }\n\n  const total=sum;\n  const len = val => Math.max(C*(val/total)-gap,0);\n  const Lsolar=len(solar), Ledf=len(edf), Lsurp=len(surp);\n  const offEDF  =  C*(solar/total);\n  const offSurp =  offEDF + C*(edf/total);\n\n  const svg = `\n    <svg viewBox=\"0 0 ${S} ${S}\" width=\"100%\" height=\"100%\">\n      <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"white\" stroke-width=\"${stroke}\"></circle>\n      <g transform=\"rotate(-90 ${cx} ${cy})\">\n        <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${cSolar}\" stroke-width=\"${stroke}\"\n                stroke-dasharray=\"${Lsolar} ${C}\"></circle>\n        <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${cEDF}\" stroke-width=\"${stroke}\"\n                stroke-dasharray=\"${Ledf} ${C}\" stroke-dashoffset=\"-${offEDF}\"></circle>\n        <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${cSurp}\" stroke-width=\"${stroke}\"\n                stroke-dasharray=\"${Lsurp} ${C}\" stroke-dashoffset=\"-${offSurp}\"></circle>\n      </g>\n    </svg>`;\n  return centerLegend(svg);\n]]]\n"
                  }
                },
                {
                  "type": "custom:button-card",
                  "show_name": false,
                  "show_state": false,
                  "styles": {
                    "card": [
                      {
                        "padding": "6px"
                      },
                      {
                        "border-radius": "16px"
                      },
                      {
                        "--ring-max": "280px"
                      }
                    ],
                    "grid": [
                      {
                        "grid-template-areas": "\"title\" \"ring\""
                      },
                      {
                        "grid-template-rows": "auto 1fr"
                      },
                      {
                        "grid-template-columns": "1fr"
                      }
                    ],
                    "custom_fields": {
                      "title": [
                        {
                          "justify-self": "start"
                        },
                        {
                          "font-weight": 600
                        },
                        {
                          "font-size": "1rem"
                        },
                        {
                          "padding": "0 2px 4px"
                        }
                      ],
                      "ring": [
                        {
                          "width": "100%"
                        },
                        {
                          "max-width": "var(--ring-max)"
                        },
                        {
                          "aspect-ratio": "1 / 1"
                        },
                        {
                          "margin": "0 auto"
                        },
                        {
                          "justify-self": "center"
                        }
                      ]
                    }
                  },
                  "custom_fields": {
                    "title": "Batterie",
                    "ring": "[[[\n  const soc = Math.round(Number(states['sensor.solarbank_3_e2700_pro_etat_de_charge']?.state) || 0);\n  const p   = Number(states['sensor.solarbank_3_e2700_pro_puissance_de_charge']?.state) || 0;\n  const charging = p > 20, discharg = p < -20;\n\n  // Géométrie identique au camembert (viewBox fixe, rendu responsive)\n  const S=200, cx=100, cy=100, r=76, stroke=32;\n  const C=2*Math.PI*r;\n\n  const color = charging ? 'var(--success-color, #16a34a)'\n                         : (discharg ? 'var(--error-color, #ef4444)'\n                                     : 'var(--secondary-text-color)');\n  const sign  = charging ? '+' : (discharg ? '−' : '');\n  const watts = (charging || discharg) ? `${sign}${Math.round(Math.abs(p))} W` : '0 W';\n\n  // Polices responsives\n  const sizePx = this.offsetWidth || 220;\n  const f = (min, k, max)=>Math.max(min, Math.min(max, sizePx*k));\n  const fsPct = f(14, .055, 18);\n  const fsW   = f(12, .05, 16);\n\n  const Lcol = Math.max(C * (soc/100), 0);\n  const Lrem = Math.max(C - Lcol, 0);\n\n  return `\n    <div style=\"position:relative;width:100%;height:100%;\">\n      <svg viewBox=\"0 0 ${S} ${S}\" width=\"100%\" height=\"100%\">\n        <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"white\" stroke-width=\"${stroke}\"></circle>\n        <g transform=\"rotate(-90 ${cx} ${cy})\">\n          <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\" stroke=\"${color}\" stroke-width=\"${stroke}\"\n                  stroke-dasharray=\"${Lcol} ${C}\"></circle>\n          <circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"none\"\n                  stroke=\"var(--disabled-color)\" stroke-width=\"${stroke}\"\n                  stroke-dasharray=\"${Lrem} ${C}\" stroke-dashoffset=\"-${Lcol}\"></circle>\n        </g>\n      </svg>\n      <div style=\"position:absolute;inset:0;display:grid;place-items:center;\">\n        <div style=\"text-align:center;line-height:1;display:flex;flex-direction:column;gap:2px\">\n          <ha-icon icon=\"${charging ? 'mdi:battery-charging' : (discharg ? 'mdi:battery-arrow-down' : 'mdi:battery')}\"\n                   style=\"width:20px;height:20px;color:${color};\"></ha-icon>\n          <div style=\"font-weight:700;font-size:${fsPct}px;\">${soc}%</div>\n          <div style=\"font-size:${fsW}px;color:${color};\">${watts}</div>\n        </div>\n      </div>\n    </div>\n  `;\n]]]\n"
                  }
                }
              ]
            }
          ]
        },
        {
          "title": "Plan",
          "path": "plan",
          "icon": "mdi:floor-plan",
          "cards": [
            {
              "type": "picture-elements",
              "image": "/local/Plan/IMG_RDC3.jpg",
              "elements": [
                {
                  "type": "state-label",
                  "entity": "sensor.thermo_salon_temperature",
                  "style": {
                    "top": "33%",
                    "left": "48%",
                    "color": "rgb(207,238,0)",
                    "font-weight": "bold",
                    "font-size": "24px"
                  }
                },
                {
                  "type": "state-label",
                  "entity": "sensor.thermo_garage_temperature",
                  "style": {
                    "left": "80%",
                    "top": "73%",
                    "color": "rgb(207,238,0)",
                    "font-weight": "bold",
                    "font-size": "24px"
                  }
                },
                {
                  "type": "state-label",
                  "entity": "sensor.daikin_split_salon_climatecontrol_outdoor_temperature",
                  "style": {
                    "top": "88%",
                    "left": "30%",
                    "color": "rgb(0,238,207)",
                    "font-weight": "bold",
                    "font-size": "24px"
                  }
                }
              ]
            }
          ]
        },
        {
          "title": "Planning ",
          "path": "planning",
          "icon": "mdi:calendar-account-outline",
          "panel": true,
          "badges": [],
          "cards": [
            {
              "type": "custom:week-planner-card",
              "title": "",
              "class": "col-12",
              "hideWeekend": false,
              "calendars": [
                {
                  "entity": "calendar.planning_cours_isa",
                  "color": "#e6c229"
                },
                {
                  "entity": "calendar.jours_feries_en_france",
                  "color": "#1a8fe3"
                },
                {
                  "entity": "calendar.vacances_scolaires",
                  "color": "#d11149"
                }
              ],
              "weather": {
                "entity": "weather.sanguinet",
                "showTemperature": true,
                "showLowTemperature": true
              },
              "startingDay": "today",
              "startingDayOffset": 0,
              "days": 15,
              "noCardBackground": true,
              "eventBackground": "rgba(0, 0, 0, .75)",
              "compact": false,
              "updateInterval": 300,
              "texts": {
                "today": "Aujourd’hui",
                "tomorrow": "Demain",
                "noEvents": "",
                "fullDay": ""
              },
              "card_mod": {
                "style": "ha-card {\n  margin-top: 1px;\n}\n.none {\n  background-color: green !important;\n  opacity: .3;\n}\n.event.past {\n  opacity: .7;\n}\n"
              }
            }
          ],
          "type": "panel",
          "theme": "geek_light"
        }
      ],
      "title": "Maison"
    }
  }
}